        -:    0:Source:gui/jmrg_radio_button.c
        -:    1:#include <stdlib.h>	/* For malloc() */
        -:    2:#include <string.h>	/* For memset() */
        -:    3:#include "jmpxrds_gui.h"
        -:    4:
        -:    5:/*****************\
        -:    6:* SIGNAL HANDLERS *
        -:    7:\*****************/
        -:    8:
        -:    9:static void
       14:   10:jmrg_radio_button_toggle(__attribute__((unused)) GtkToggleButton *widget,
        -:   11:			 gpointer data)
        -:   12:{
       14:   13:	struct value_map *vmap = (struct value_map*) data;
       14:   14:	(*(int*)vmap->val_ptr) = vmap->val;
       14:   15:	return;
        -:   16:}
        -:   17:
        -:   18:
        -:   19:/*************\
        -:   20:* ENTRY POINT *
        -:   21:\*************/
        -:   22:
        -:   23:GtkWidget*
        7:   24:jmrg_radio_button_init(const char* label, int *val_ptr, int val,
        -:   25:		       GtkRadioButton* previous)
        -:   26:{
        7:   27:	GtkWidget *rbutton = NULL;
        7:   28:	struct value_map *vmap = NULL;
        -:   29:
        7:   30:	rbutton = gtk_radio_button_new_with_label_from_widget(previous, label);
        7:   31:	if(!rbutton)
    #####:   32:		goto cleanup;
        -:   33:
        -:   34:	/* Initialize value_map */
        7:   35:	vmap = (struct value_map*) malloc(sizeof(struct value_map));
        7:   36:	if(!vmap)
    #####:   37:		return NULL;
        7:   38:	memset(vmap, 0, sizeof(struct value_map));	
        7:   39:	vmap->val_ptr = val_ptr;
        7:   40:	vmap->val = val;
        -:   41:
        -:   42:	/* Register signal hanlders */
        7:   43:	g_signal_connect(rbutton, "toggled",
        -:   44:			 G_CALLBACK(jmrg_radio_button_toggle),
        -:   45:			 vmap);
        -:   46:
        7:   47:	g_signal_connect(rbutton, "unrealize",
        -:   48:			 G_CALLBACK(jmrg_free_vmap),
        -:   49:			 vmap);
        -:   50:
        7:   51:	return rbutton;
    #####:   52: cleanup:
    #####:   53:	if(rbutton)
    #####:   54:		gtk_widget_destroy(rbutton);
    #####:   55:	return NULL;
        -:   56:}
